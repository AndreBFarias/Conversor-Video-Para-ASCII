{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Pantheon Entity Schema",
  "description": "Schema padronizado para entidades do sistema Pantheon Luna",
  "version": "1.0.0",

  "type": "object",
  "required": ["id", "name", "gender", "persona", "voice", "aesthetics"],

  "properties": {
    "id": {
      "type": "string",
      "description": "Identificador unico da entidade (lowercase, sem espacos)",
      "pattern": "^[a-z][a-z0-9_]*$"
    },
    "name": {
      "type": "string",
      "description": "Nome de exibicao da entidade"
    },
    "gender": {
      "type": "string",
      "enum": ["feminine", "masculine", "neutral"],
      "description": "Genero da entidade para tratamento e voz"
    },
    "voice_id": {
      "type": "string",
      "description": "ID da voz ElevenLabs (se usar)"
    },
    "age": {
      "type": "integer",
      "minimum": 18,
      "maximum": 99,
      "description": "Idade aparente da entidade"
    },

    "persona": {
      "type": "object",
      "required": ["archetype", "tone"],
      "properties": {
        "archetype": {
          "type": "array",
          "items": { "type": "string" },
          "minItems": 1,
          "maxItems": 5,
          "description": "Lista de arquetipos que definem a personalidade"
        },
        "reference": {
          "type": "string",
          "description": "Referencias culturais para a personalidade"
        },
        "inspirations": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["name", "trait"],
            "properties": {
              "name": { "type": "string" },
              "trait": { "type": "string" }
            }
          },
          "description": "Personagens ou figuras de inspiracao"
        },
        "tone": {
          "type": "object",
          "required": ["primary", "forbidden"],
          "properties": {
            "primary": {
              "type": "string",
              "description": "Tom principal da personalidade"
            },
            "secondary": {
              "type": "string",
              "description": "Tom secundario/alternativo"
            },
            "forbidden": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Comportamentos proibidos para a entidade"
            }
          }
        },
        "problem_solving_style": {
          "type": "string",
          "description": "Como a entidade aborda problemas"
        },
        "flaw": {
          "type": "string",
          "description": "Falha de carater da entidade"
        }
      }
    },

    "voice": {
      "type": "object",
      "properties": {
        "elevenlabs": {
          "type": "object",
          "properties": {
            "voice_id": { "type": "string" },
            "model": { "type": "string", "default": "eleven_multilingual_v2" },
            "stability": { "type": "number", "minimum": 0, "maximum": 1 },
            "similarity_boost": { "type": "number", "minimum": 0, "maximum": 1 },
            "style": { "type": "number", "minimum": 0, "maximum": 1 },
            "use_speaker_boost": { "type": "boolean" }
          }
        },
        "coqui": {
          "type": "object",
          "required": ["reference_audio"],
          "properties": {
            "reference_audio": {
              "type": "string",
              "description": "Path relativo para audio de referencia"
            },
            "speaker_embedding": {
              "type": "string",
              "description": "Path relativo para embedding do speaker"
            },
            "language": {
              "type": "string",
              "default": "pt"
            }
          }
        },
        "chatterbox": {
          "type": "object",
          "required": ["reference_audio"],
          "properties": {
            "reference_audio": {
              "type": "string",
              "description": "Path relativo para audio de referencia"
            },
            "exaggeration": {
              "type": "number",
              "minimum": 0,
              "maximum": 1,
              "default": 0.3
            },
            "cfg_weight": {
              "type": "number",
              "minimum": 0,
              "maximum": 1,
              "default": 0.5
            }
          }
        },
        "characteristics": {
          "type": "object",
          "properties": {
            "texture": {
              "type": "array",
              "items": { "type": "string" }
            },
            "pitch": { "type": "string" },
            "rhythm": { "type": "string" },
            "accent": { "type": "string" }
          }
        },
        "design_prompt": {
          "type": "string",
          "description": "Prompt para design/geracao de voz"
        }
      }
    },

    "aesthetics": {
      "type": "object",
      "required": ["theme"],
      "properties": {
        "theme": {
          "type": "object",
          "required": ["primary_color", "background"],
          "properties": {
            "primary_color": {
              "type": "string",
              "pattern": "^#[0-9a-fA-F]{6}$"
            },
            "secondary_color": {
              "type": "string",
              "pattern": "^#[0-9a-fA-F]{6}$"
            },
            "accent_color": {
              "type": "string",
              "pattern": "^#[0-9a-fA-F]{6}$"
            },
            "background": {
              "type": "string",
              "pattern": "^#[0-9a-fA-F]{6}$"
            },
            "glow_color": {
              "type": "string",
              "pattern": "^#[0-9a-fA-F]{6}$"
            },
            "text_primary": {
              "type": "string",
              "pattern": "^#[0-9a-fA-F]{6}$"
            },
            "text_secondary": {
              "type": "string",
              "pattern": "^#[0-9a-fA-F]{6}$"
            }
          }
        },
        "animation_style": {
          "type": "string",
          "description": "Estilo visual das animacoes"
        },
        "banner_effect": {
          "type": "string",
          "description": "Efeito do banner/glitch"
        }
      }
    },

    "vectordb_metadata": {
      "type": "object",
      "description": "Metadados para indexacao no banco de vetores",
      "properties": {
        "embeddings_namespace": {
          "type": "string",
          "description": "Namespace para embeddings da entidade"
        },
        "searchable_traits": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Caracteristicas indexaveis para busca semantica"
        },
        "related_entities": {
          "type": "array",
          "items": { "type": "string" },
          "description": "IDs de entidades relacionadas"
        }
      }
    }
  }
}
